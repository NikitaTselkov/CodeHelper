/*!
 * 
 *     🌊 fluid-canvas 🌊 - A JavaScript library that allows for easy deployment of WebGL rendered fluid simulations.
 *     Library By: Malik Tillman
 *     Version: v0.9.1
 *     GitHub: https://github.com/malik-tillman/Fluid-JS#readme
 *     License: ISC 
 * 
 */
!function e(r, n) { "object" == typeof exports && "object" == typeof module ? module.exports = n() : "function" == typeof define && define.amd ? define([], n) : "object" == typeof exports ? exports.Fluid = n() : r.Fluid = n() }(window, function () { return function (e) { var r = {}; function n(t) { if (r[t]) return r[t].exports; var i = r[t] = { i: t, l: !1, exports: {} }; return e[t].call(i.exports, i, i.exports, n), i.l = !0, i.exports } return n.m = e, n.c = r, n.d = function (e, r, t) { n.o(e, r) || Object.defineProperty(e, r, { enumerable: !0, get: t }) }, n.r = function (e) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(e, "__esModule", { value: !0 }) }, n.t = function (e, r) { if (1 & r && (e = n(e)), 8 & r || 4 & r && "object" == typeof e && e && e.__esModule) return e; var t = Object.create(null); if (n.r(t), Object.defineProperty(t, "default", { enumerable: !0, value: e }), 2 & r && "string" != typeof e) for (var i in e) n.d(t, i, (function (r) { return e[r] }).bind(null, i)); return t }, n.n = function (e) { var r = e && e.__esModule ? function r() { return e.default } : function r() { return e }; return n.d(r, "a", r), r }, n.o = function (e, r) { return Object.prototype.hasOwnProperty.call(e, r) }, n.p = "", n(n.s = "./src/fluid.js") }({ "./assets/dither.png": function (e, r) { e.exports = "data:image/png;base64,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" }, "./src/defualts.js": function (e, r, n) { "use strict"; function t(e, r) { var n = Object.keys(e); if (Object.getOwnPropertySymbols) { var t = Object.getOwnPropertySymbols(e); r && (t = t.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable })), n.push.apply(n, t) } return n } function i(e, r, n) { return r in e ? Object.defineProperty(e, r, { value: n, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = n, e } Object.defineProperty(r, "__esModule", { value: !0 }), r.setBehaviors = function e(n) { r.behavior = o = function e(r) { for (var n = 1; n < arguments.length; n++) { var o = null != arguments[n] ? arguments[n] : {}; n % 2 ? t(o, !0).forEach(function (e) { i(r, e, o[e]) }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(r, Object.getOwnPropertyDescriptors(o)) : t(o).forEach(function (e) { Object.defineProperty(r, e, Object.getOwnPropertyDescriptor(o, e)) }) } return r }({}, o, {}, n) }, r.SHADER_SOURCE = r.DRAWING_PARAMS = r.behavior = void 0; var o = { sim_resolution: 128, dye_resolution: 512, paused: !1, clamp_values: !0, embedded_dither: !0, dissipation: .97, velocity: .98, pressure: .8, pressure_iteration: 20, fluid_color: [[0, 0, 0], [.4, .2, 0]], curl: 0, emitter_size: .5, render_shaders: !0, multi_color: !0, render_bloom: !1, bloom_iterations: 8, bloom_resolution: 256, intensity: .8, threshold: .6, soft_knee: .7, background_color: { r: 15, g: 15, b: 15 }, transparent: !1 }; r.behavior = o, r.DRAWING_PARAMS = { alpha: !0, depth: !1, stencil: !1, antialias: !1, preserveDrawingBuffer: !1, powerPreference: "default" }, r.SHADER_SOURCE = { blank: "", vertex: "\n                  precision highp float;\n              \n                  attribute vec2 aPosition;\n                  varying vec2 vUv;\n                  varying vec2 vL;\n                  varying vec2 vR;\n                  varying vec2 vT;\n                  varying vec2 vB;\n                  uniform vec2 texelSize;\n              \n                  void main () {\n                      vUv = aPosition * 0.5 + 0.5;\n                      vL = vUv - vec2(texelSize.x, 0.0);\n                      vR = vUv + vec2(texelSize.x, 0.0);\n                      vT = vUv + vec2(0.0, texelSize.y);\n                      vB = vUv - vec2(0.0, texelSize.y);\n                      gl_Position = vec4(aPosition, 0.0, 1.0);\n                  }", clear: "\n                  precision mediump float;\n                  precision mediump sampler2D;\n              \n                  varying highp vec2 vUv;\n                  uniform sampler2D uTexture;\n                  uniform float value;\n              \n                  void main () {\n                      gl_FragColor = value * texture2D(uTexture, vUv);\n                  }\n              ", color: "\n                  precision mediump float;\n              \n                  uniform vec4 color;\n              \n                  void main () {\n                      gl_FragColor = color;\n                  }\n              ", background: "\n                    void main() { \n                        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0); \n                    } \n            ", display: "\n                  precision highp float;\n                  precision highp sampler2D;\n              \n                  varying vec2 vUv;\n                  uniform sampler2D uTexture;\n              \n                  void main () {\n                      vec3 C = texture2D(uTexture, vUv).rgb;\n                      float a = max(C.r, max(C.g, C.b));\n                      gl_FragColor = vec4(C, a);\n                  }\n              ", displayBloom: "\n          precision highp float;\n          precision highp sampler2D;\n      \n          varying vec2 vUv;\n          uniform sampler2D uTexture;\n          uniform sampler2D uBloom;\n          uniform sampler2D uDithering;\n          uniform vec2 ditherScale;\n      \n          void main () {\n              vec3 C = texture2D(uTexture, vUv).rgb;\n              vec3 bloom = texture2D(uBloom, vUv).rgb;\n              vec3 noise = texture2D(uDithering, vUv * ditherScale).rgb;\n              noise = noise * 2.0 - 1.0;\n              bloom += noise / 800.0;\n              bloom = pow(bloom.rgb, vec3(1.0 / 2.2));\n              C += bloom;\n              float a = max(C.r, max(C.g, C.b));\n              gl_FragColor = vec4(C, a);\n          }\n      ", displayShading: "\n          precision highp float;\n          precision highp sampler2D;\n      \n          varying vec2 vUv;\n          varying vec2 vL;\n          varying vec2 vR;\n          varying vec2 vT;\n          varying vec2 vB;\n          uniform sampler2D uTexture;\n          uniform vec2 texelSize;\n      \n          void main () {\n              vec3 L = texture2D(uTexture, vL).rgb;\n              vec3 R = texture2D(uTexture, vR).rgb;\n              vec3 T = texture2D(uTexture, vT).rgb;\n              vec3 B = texture2D(uTexture, vB).rgb;\n              vec3 C = texture2D(uTexture, vUv).rgb;\n      \n              float dx = length(R) - length(L);\n              float dy = length(T) - length(B);\n      \n              vec3 n = normalize(vec3(dx, dy, length(texelSize)));\n              vec3 l = vec3(0.0, 0.0, 1.0);\n      \n              float diffuse = clamp(dot(n, l) + 0.7, 0.7, 1.0);\n              C.rgb *= diffuse;\n      \n              float a = max(C.r, max(C.g, C.b));\n              gl_FragColor = vec4(C, a);\n          }\n      ", displayBloomShading: "\n          precision highp float;\n          precision highp sampler2D;\n      \n          varying vec2 vUv;\n          varying vec2 vL;\n          varying vec2 vR;\n          varying vec2 vT;\n          varying vec2 vB;\n          uniform sampler2D uTexture;\n          uniform sampler2D uBloom;\n          uniform sampler2D uDithering;\n          uniform vec2 ditherScale;\n          uniform vec2 texelSize;\n      \n          void main () {\n              vec3 L = texture2D(uTexture, vL).rgb;\n              vec3 R = texture2D(uTexture, vR).rgb;\n              vec3 T = texture2D(uTexture, vT).rgb;\n              vec3 B = texture2D(uTexture, vB).rgb;\n              vec3 C = texture2D(uTexture, vUv).rgb;\n      \n              float dx = length(R) - length(L);\n              float dy = length(T) - length(B);\n      \n              vec3 n = normalize(vec3(dx, dy, length(texelSize)));\n              vec3 l = vec3(0.0, 0.0, 1.0);\n      \n              float diffuse = clamp(dot(n, l) + 0.7, 0.7, 1.0);\n              C *= diffuse;\n      \n              vec3 bloom = texture2D(uBloom, vUv).rgb;\n              vec3 noise = texture2D(uDithering, vUv * ditherScale).rgb;\n              noise = noise * 2.0 - 1.0;\n              bloom += noise / 800.0;\n              bloom = pow(bloom.rgb, vec3(1.0 / 2.2));\n              C += bloom;\n      \n              float a = max(C.r, max(C.g, C.b));\n              gl_FragColor = vec4(C, a);\n          }\n      ", bloomPreFilter: "\n          precision mediump float;\n          precision mediump sampler2D;\n      \n          varying vec2 vUv;\n          uniform sampler2D uTexture;\n          uniform vec3 curve;\n          uniform float threshold;\n      \n          void main () {\n              vec3 c = texture2D(uTexture, vUv).rgb;\n              float br = max(c.r, max(c.g, c.b));\n              float rq = clamp(br - curve.x, 0.0, curve.y);\n              rq = curve.z * rq * rq;\n              c *= max(rq, br - threshold) / max(br, 0.0001);\n              gl_FragColor = vec4(c, 0.0);\n          }\n      ", bloomBlur: "\n          precision mediump float;\n          precision mediump sampler2D;\n      \n          varying vec2 vL;\n          varying vec2 vR;\n          varying vec2 vT;\n          varying vec2 vB;\n          uniform sampler2D uTexture;\n      \n          void main () {\n              vec4 sum = vec4(0.0);\n              sum += texture2D(uTexture, vL);\n              sum += texture2D(uTexture, vR);\n              sum += texture2D(uTexture, vT);\n              sum += texture2D(uTexture, vB);\n              sum *= 0.25;\n              gl_FragColor = sum;\n          }\n      ", bloomFinal: "\n          precision mediump float;\n          precision mediump sampler2D;\n      \n          varying vec2 vL;\n          varying vec2 vR;\n          varying vec2 vT;\n          varying vec2 vB;\n          uniform sampler2D uTexture;\n          uniform float intensity;\n      \n          void main () {\n              vec4 sum = vec4(0.0);\n              sum += texture2D(uTexture, vL);\n              sum += texture2D(uTexture, vR);\n              sum += texture2D(uTexture, vT);\n              sum += texture2D(uTexture, vB);\n              sum *= 0.25;\n              gl_FragColor = sum * intensity;\n          }\n      ", splat: "\n          precision highp float;\n          precision highp sampler2D;\n      \n          varying vec2 vUv;\n          uniform sampler2D uTarget;\n          uniform float aspectRatio;\n          uniform vec3 color;\n          uniform vec2 point;\n          uniform float radius;\n      \n          void main () {\n              vec2 p = vUv - point.xy;\n              p.x *= aspectRatio;\n              vec3 splat = exp(-dot(p, p) / radius) * color;\n              vec3 base = texture2D(uTarget, vUv).xyz;\n              gl_FragColor = vec4(base + splat, 1.0);\n          }\n      ", advectionManualFiltering: "\n          precision highp float;\n          precision highp sampler2D;\n      \n          varying vec2 vUv;\n          uniform sampler2D uVelocity;\n          uniform sampler2D uSource;\n          uniform vec2 texelSize;\n          uniform vec2 dyeTexelSize;\n          uniform float dt;\n          uniform float dissipation;\n      \n          vec4 bilerp (sampler2D sam, vec2 uv, vec2 tsize) {\n              vec2 st = uv / tsize - 0.5;\n      \n              vec2 iuv = floor(st);\n              vec2 fuv = fract(st);\n      \n              vec4 a = texture2D(sam, (iuv + vec2(0.5, 0.5)) * tsize);\n              vec4 b = texture2D(sam, (iuv + vec2(1.5, 0.5)) * tsize);\n              vec4 c = texture2D(sam, (iuv + vec2(0.5, 1.5)) * tsize);\n              vec4 d = texture2D(sam, (iuv + vec2(1.5, 1.5)) * tsize);\n      \n              return mix(mix(a, b, fuv.x), mix(c, d, fuv.x), fuv.y);\n          }\n      \n          void main () {\n              vec2 coord = vUv - dt * bilerp(uVelocity, vUv, texelSize).xy * texelSize;\n              gl_FragColor = dissipation * bilerp(uSource, coord, dyeTexelSize);\n              gl_FragColor.a = 1.0;\n          }\n      ", advection: "\n          precision highp float;\n          precision highp sampler2D;\n      \n          varying vec2 vUv;\n          uniform sampler2D uVelocity;\n          uniform sampler2D uSource;\n          uniform vec2 texelSize;\n          uniform float dt;\n          uniform float dissipation;\n      \n          void main () {\n              vec2 coord = vUv - dt * texture2D(uVelocity, vUv).xy * texelSize;\n              gl_FragColor = dissipation * texture2D(uSource, coord);\n              gl_FragColor.a = 1.0;\n          }\n      ", divergence: "\n          precision mediump float;\n          precision mediump sampler2D;\n      \n          varying highp vec2 vUv;\n          varying highp vec2 vL;\n          varying highp vec2 vR;\n          varying highp vec2 vT;\n          varying highp vec2 vB;\n          uniform sampler2D uVelocity;\n      \n          void main () {\n              float L = texture2D(uVelocity, vL).x;\n              float R = texture2D(uVelocity, vR).x;\n              float T = texture2D(uVelocity, vT).y;\n              float B = texture2D(uVelocity, vB).y;\n      \n              vec2 C = texture2D(uVelocity, vUv).xy;\n              if (vL.x < 0.0) { L = -C.x; }\n              if (vR.x > 1.0) { R = -C.x; }\n              if (vT.y > 1.0) { T = -C.y; }\n              if (vB.y < 0.0) { B = -C.y; }\n      \n              float div = 0.5 * (R - L + T - B);\n              gl_FragColor = vec4(div, 0.0, 0.0, 1.0);\n          }\n      ", curl: "\n          precision mediump float;\n          precision mediump sampler2D;\n      \n          varying highp vec2 vUv;\n          varying highp vec2 vL;\n          varying highp vec2 vR;\n          varying highp vec2 vT;\n          varying highp vec2 vB;\n          uniform sampler2D uVelocity;\n      \n          void main () {\n              float L = texture2D(uVelocity, vL).y;\n              float R = texture2D(uVelocity, vR).y;\n              float T = texture2D(uVelocity, vT).x;\n              float B = texture2D(uVelocity, vB).x;\n              float vorticity = R - L - T + B;\n              gl_FragColor = vec4(0.5 * vorticity, 0.0, 0.0, 1.0);\n          }\n      ", vorticity: "\n          precision highp float;\n          precision highp sampler2D;\n      \n          varying vec2 vUv;\n          varying vec2 vL;\n          varying vec2 vR;\n          varying vec2 vT;\n          varying vec2 vB;\n          uniform sampler2D uVelocity;\n          uniform sampler2D uCurl;\n          uniform float curl;\n          uniform float dt;\n      \n          void main () {\n              float L = texture2D(uCurl, vL).x;\n              float R = texture2D(uCurl, vR).x;\n              float T = texture2D(uCurl, vT).x;\n              float B = texture2D(uCurl, vB).x;\n              float C = texture2D(uCurl, vUv).x;\n      \n              vec2 force = 0.5 * vec2(abs(T) - abs(B), abs(R) - abs(L));\n              force /= length(force) + 0.0001;\n              force *= curl * C;\n              force.y *= -1.0;\n      \n              vec2 vel = texture2D(uVelocity, vUv).xy;\n              gl_FragColor = vec4(vel + force * dt, 0.0, 1.0);\n          }\n      ", pressure: "\n          precision mediump float;\n          precision mediump sampler2D;\n      \n          varying highp vec2 vUv;\n          varying highp vec2 vL;\n          varying highp vec2 vR;\n          varying highp vec2 vT;\n          varying highp vec2 vB;\n          uniform sampler2D uPressure;\n          uniform sampler2D uDivergence;\n      \n          vec2 boundary (vec2 uv) {\n              return uv;\n              // uncomment if you use wrap or repeat texture mode\n              // uv = min(max(uv, 0.0), 1.0);\n              // return uv;\n          }\n      \n          void main () {\n              float L = texture2D(uPressure, boundary(vL)).x;\n              float R = texture2D(uPressure, boundary(vR)).x;\n              float T = texture2D(uPressure, boundary(vT)).x;\n              float B = texture2D(uPressure, boundary(vB)).x;\n              float C = texture2D(uPressure, vUv).x;\n              float divergence = texture2D(uDivergence, vUv).x;\n              float pressure = (L + R + B + T - divergence) * 0.25;\n              gl_FragColor = vec4(pressure, 0.0, 0.0, 1.0);\n          }\n      ", gradientSubtract: "\n          precision mediump float;\n          precision mediump sampler2D;\n      \n          varying highp vec2 vUv;\n          varying highp vec2 vL;\n          varying highp vec2 vR;\n          varying highp vec2 vT;\n          varying highp vec2 vB;\n          uniform sampler2D uPressure;\n          uniform sampler2D uVelocity;\n      \n          vec2 boundary (vec2 uv) {\n              return uv;\n              // uv = min(max(uv, 0.0), 1.0);\n              // return uv;\n          }\n      \n          void main () {\n              float L = texture2D(uPressure, boundary(vL)).x;\n              float R = texture2D(uPressure, boundary(vR)).x;\n              float T = texture2D(uPressure, boundary(vT)).x;\n              float B = texture2D(uPressure, boundary(vB)).x;\n              vec2 velocity = texture2D(uVelocity, vUv).xy;\n              velocity.xy -= vec2(R - L, T - B);\n              gl_FragColor = vec4(velocity, 0.0, 1.0);\n          }\n      " } }, "./src/fluid.js": function (e, r, n) { "use strict"; var t = n(/*! ./defualts */ "./src/defualts.js"), i = n(/*! ./initializer */ "./src/initializer.js"); function o(e, r) { var n = Object.keys(e); if (Object.getOwnPropertySymbols) { var t = Object.getOwnPropertySymbols(e); r && (t = t.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable })), n.push.apply(n, t) } return n } function a(e, r, n) { return r in e ? Object.defineProperty(e, r, { value: n, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = n, e } function u(e, r) { for (var n = 0; n < r.length; n++) { var t = r[n]; t.enumerable = t.enumerable || !1, t.configurable = !0, "value" in t && (t.writable = !0), Object.defineProperty(e, t.key, t) } } e.exports = function () { var e, r, n; function v(e) { !function e(r, n) { if (!(r instanceof n)) throw TypeError("Cannot call a class as a function") }(this, v), this.PARAMS = t.behavior, e.width = e.clientWidth, e.height = e.clientHeight, this.canvas = e; var r = (0, i.initWebGL)(), n = r.programs, o = r.webGL, a = r.colorFormats, u = r.pointers; this.programs = n, this.webGL = o, this.colorFormats = a, this.pointers = u } return e = v, r = [{ key: "activate", value: function e() { (0, i.activator)(this.canvas, this.webGL, this.colorFormats, this.programs, this.pointers) } }, { key: "deactivate", value: function e() { } }, { key: "reset", value: function e() { (0, i.initWebGL)(), this.activate() } }, { key: "mapBehaviors", value: function e(r) { this.PARAMS = function e(r) { for (var n = 1; n < arguments.length; n++) { var t = null != arguments[n] ? arguments[n] : {}; n % 2 ? o(t, !0).forEach(function (e) { a(r, e, t[e]) }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(r, Object.getOwnPropertyDescriptors(t)) : o(t).forEach(function (e) { Object.defineProperty(r, e, Object.getOwnPropertyDescriptor(t, e)) }) } return r }({}, this.PARAMS, {}, r), (0, t.setBehaviors)(this.PARAMS) } }, { key: "setAsBackground", value: function e() { var r = !(arguments.length > 0) || void 0 === arguments[0] || arguments[0]; canvas.style.zIndex = r ? "-99" : "0", canvas.style.position = r ? "absolute" : "relative" } }, { key: "applyBackground", value: function e(r, n) { var t = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : null, i = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : this.canvas; switch (r = r.toLowerCase(), this.PARAMS.transparent = !0, r) { case "gradient": (function e() { var r = ""; switch (t) { case "radial": r = "radial-gradient(" + n + ")"; break; case "conic": r = "conic-gradient(" + n + ")"; break; case "repeating-linear": r = "repeating-linear-gradient(" + n + ")"; break; case "repeating-radial": r = "repeating-radial-gradient(" + n + ")"; break; default: r = "linear-gradient(" + n + ")" }i.style.backgroundImage = r })(); break; case "image": i.style.backgroundImage = "url('" + n + "')", t && (i.style.backgroundRepeat = t.repeat ? "repeat" : "no-repeat", i.style.backgroundPosition = t.position ? t.position : "center", i.style.backgroundSize = t.size ? t.size : "contain", i.style.backgroundColor = t.color ? t.color : "none"); break; default: this.PARAMS.transparent = !1, this.PARAMS.background_color = n }this.reset() } }, { key: "setDitherURL", value: function e(r) { (0, i.setDitherURL)(r) } }], u(e.prototype, r), n && u(e, n), v }() }, "./src/initializer.js": function (e, r, n) { "use strict"; Object.defineProperty(r, "__esModule", { value: !0 }), r.initWebGL = function e() { var r = []; r.push(new s); var n = canvas.getContext("webgl2", t.DRAWING_PARAMS), i = !!n; i || (n = canvas.getContext("webgl", t.DRAWING_PARAMS) || canvas.getContext("experimental-webgl", t.DRAWING_PARAMS)); var o, a = function e() { i ? (n.getExtension("EXT_color_buffer_float"), u = n.getExtension("OES_texture_float_linear")) : (a = n.getExtension("OES_texture_half_float"), u = n.getExtension("OES_texture_half_float_linear")); var r, t, o, a, u, v = i ? n.HALF_FLOAT : a.HALF_FLOAT_OES; function l(e, r, t) { var i, o = n.createTexture(); n.bindTexture(n.TEXTURE_2D, o), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_MIN_FILTER, n.NEAREST), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_MAG_FILTER, n.NEAREST), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_WRAP_S, n.CLAMP_TO_EDGE), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_WRAP_T, n.CLAMP_TO_EDGE), n.texImage2D(n.TEXTURE_2D, 0, e, 4, 4, 0, r, t, null); var a = n.createFramebuffer(); if (n.bindFramebuffer(n.FRAMEBUFFER, a), n.framebufferTexture2D(n.FRAMEBUFFER, n.COLOR_ATTACHMENT0, n.TEXTURE_2D, o, 0), !(i = n.checkFramebufferStatus(n.FRAMEBUFFER) === n.FRAMEBUFFER_COMPLETE)) switch (e) { case n.R16F: return l(n.RG16F, n.RG, t); case n.RG16F: return l(n.RGBA16F, n.RGBA, t); default: return null }return { internalFormat: e, format: r } } return n.clearColor(0, 0, 0, 1), i ? (r = l(n.RGBA16F, n.RGBA, v), t = l(n.RG16F, n.RG, v), o = l(n.R16F, n.RED, v)) : (r = l(n.RGBA, n.RGBA, v), t = l(n.RGBA, n.RGBA, v), o = l(n.RGBA, n.RGBA, v)), { formatRGBA: r, formatRG: t, formatR: o, halfFloatTexType: v, supportLinearFiltering: u } }(); /Mobi|Android/i.test(navigator.userAgent) && (t.behavior.render_shaders = !1), a.supportLinearFiltering || (t.behavior.render_shaders = !1, t.behavior.render_bloom = !1); var u = { baseVertex: l(n.VERTEX_SHADER, t.SHADER_SOURCE.vertex), clear: l(n.FRAGMENT_SHADER, t.SHADER_SOURCE.clear), color: l(n.FRAGMENT_SHADER, t.SHADER_SOURCE.color), background: l(n.FRAGMENT_SHADER, t.SHADER_SOURCE.background), display: l(n.FRAGMENT_SHADER, t.SHADER_SOURCE.display), displayBloom: l(n.FRAGMENT_SHADER, t.SHADER_SOURCE.displayBloom), displayShading: l(n.FRAGMENT_SHADER, t.SHADER_SOURCE.displayShading), displayBloomShading: l(n.FRAGMENT_SHADER, t.SHADER_SOURCE.displayBloomShading), bloomPreFilter: l(n.FRAGMENT_SHADER, t.SHADER_SOURCE.bloomPreFilter), bloomBlur: l(n.FRAGMENT_SHADER, t.SHADER_SOURCE.bloomBlur), bloomFinal: l(n.FRAGMENT_SHADER, t.SHADER_SOURCE.bloomFinal), splat: l(n.FRAGMENT_SHADER, t.SHADER_SOURCE.splat), advectionManualFiltering: l(n.FRAGMENT_SHADER, t.SHADER_SOURCE.advectionManualFiltering), advection: l(n.FRAGMENT_SHADER, t.SHADER_SOURCE.advection), divergence: l(n.FRAGMENT_SHADER, t.SHADER_SOURCE.divergence), curl: l(n.FRAGMENT_SHADER, t.SHADER_SOURCE.curl), vorticity: l(n.FRAGMENT_SHADER, t.SHADER_SOURCE.vorticity), pressure: l(n.FRAGMENT_SHADER, t.SHADER_SOURCE.pressure), gradientSubtract: l(n.FRAGMENT_SHADER, t.SHADER_SOURCE.gradientSubtract) }, v = (o = a.supportLinearFiltering, { clearProgram: new f(u.baseVertex, u.clear, n), colorProgram: new f(u.baseVertex, u.color, n), backgroundProgram: new f(u.baseVertex, u.background, n), displayProgram: new f(u.baseVertex, u.display, n), displayBloomProgram: new f(u.baseVertex, u.displayBloom, n), displayShadingProgram: new f(u.baseVertex, u.displayShading, n), displayBloomShadingProgram: new f(u.baseVertex, u.displayBloomShading, n), bloomPreFilterProgram: new f(u.baseVertex, u.bloomPreFilter, n), bloomBlurProgram: new f(u.baseVertex, u.bloomBlur, n), bloomFinalProgram: new f(u.baseVertex, u.bloomFinal, n), splatProgram: new f(u.baseVertex, u.splat, n), advectionProgram: new f(u.baseVertex, o ? u.advection : u.advectionManualFiltering, n), divergenceProgram: new f(u.baseVertex, u.divergence, n), curlProgram: new f(u.baseVertex, u.curl, n), vorticityProgram: new f(u.baseVertex, u.vorticity, n), pressureProgram: new f(u.baseVertex, u.pressure, n), gradientSubtractProgram: new f(u.baseVertex, u.gradientSubtract, n) }); function l(e, r) { var t = n.createShader(e); if (n.shaderSource(t, r), n.compileShader(t), !n.getShaderParameter(t, n.COMPILE_STATUS)) throw n.getShaderInfoLog(t); return t } return { programs: v, webGL: n, colorFormats: a, pointers: r } }, r.activator = function e(r, n, o, a, u) { if (v) { var m, f, c, d, g, p, h, $, S, b, y = []; y.push(new s), u = y } v = !0; var R = t.behavior, T = [], E = [], x = (n.bindBuffer(n.ARRAY_BUFFER, n.createBuffer()), n.bufferData(n.ARRAY_BUFFER, new Float32Array([-1, -1, -1, 1, 1, 1, 1, -1]), n.STATIC_DRAW), n.bindBuffer(n.ELEMENT_ARRAY_BUFFER, n.createBuffer()), n.bufferData(n.ELEMENT_ARRAY_BUFFER, new Uint16Array([0, 1, 2, 0, 2, 3]), n.STATIC_DRAW), n.vertexAttribPointer(0, 2, n.FLOAT, !1, 0, 0), n.enableVertexAttribArray(0), function (e) { n.bindFramebuffer(n.FRAMEBUFFER, e), n.drawElements(n.TRIANGLES, 6, n.UNSIGNED_SHORT, 0) }), P = function e(r) { var t = n.createTexture(); return n.bindTexture(n.TEXTURE_2D, t), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_MIN_FILTER, n.LINEAR), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_MAG_FILTER, n.LINEAR), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_WRAP_S, n.REPEAT), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_WRAP_T, n.REPEAT), n.texImage2D(n.TEXTURE_2D, 0, n.RGB, 1, 1, 0, n.RGB, n.UNSIGNED_BYTE, new Uint8Array([255, 255, 255])), { texture: t, width: 1, height: 1, attach: function e(r) { return n.activeTexture(n.TEXTURE0 + r), n.bindTexture(n.TEXTURE_2D, t), r } } }(R.embedded_dither ? i.default : l); D(); var k = Date.now(); function D() { var e = o.halfFloatTexType, r = o.formatRGBA, t = o.formatRG, i = o.formatR, a = o.supportLinearFiltering ? n.LINEAR : n.NEAREST, u = F(R.sim_resolution), v = F(R.dye_resolution), l = F(R.bloom_resolution); m = u.width, f = u.height, c = v.width, d = v.height, g = g ? A(g, c, d, r.internalFormat, r.format, e, a) : _(c, d, r.internalFormat, r.format, e, a), p = p ? A(p, m, f, t.internalFormat, t.format, e, a) : _(m, f, t.internalFormat, t.format, e, a), b = J(l.width, l.height, r.internalFormat, r.format, e, a), h = J(m, f, i.internalFormat, i.format, e, n.NEAREST), $ = J(m, f, i.internalFormat, i.format, e, n.NEAREST), S = _(m, f, i.internalFormat, i.format, e, n.NEAREST), T.length = 0; for (var s = 0; s < R.bloom_iterations; s++) { var y = l.width >> s + 1, E = l.height >> s + 1; if (y < 2 || E < 2) break; var x = J(y, E, r.internalFormat, r.format, e, a); T.push(x) } } function _(e, r, n, t, i, o) { var a = J(e, r, n, t, i, o), u = J(e, r, n, t, i, o); return { get read() { return a }, set read(value) { a = value }, get write() { return u }, set write(value) { u = value }, swap: function e() { var r = a; a = u, u = r } } } function J(e, r, t, i, o, a) { n.activeTexture(n.TEXTURE0); var u = n.createTexture(); n.bindTexture(n.TEXTURE_2D, u), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_MIN_FILTER, a), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_MAG_FILTER, a), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_WRAP_S, n.CLAMP_TO_EDGE), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_WRAP_T, n.CLAMP_TO_EDGE), n.texImage2D(n.TEXTURE_2D, 0, t, e, r, 0, i, o, null); var v = n.createFramebuffer(); return n.bindFramebuffer(n.FRAMEBUFFER, v), n.framebufferTexture2D(n.FRAMEBUFFER, n.COLOR_ATTACHMENT0, n.TEXTURE_2D, u, 0), n.viewport(0, 0, e, r), n.clear(n.COLOR_BUFFER_BIT), { texture: u, fbo: v, width: e, height: r, attach: function e(r) { return n.activeTexture(n.TEXTURE0 + r), n.bindTexture(n.TEXTURE_2D, u), r } } } function A(e, r, t, i, o, u, v) { var l, m, f, s, c, d, g, p; return e.read = (l = e.read, m = r, f = t, s = i, c = o, d = u, g = v, p = J(m, f, s, c, d, g), a.clearProgram.bind(), n.uniform1i(a.clearProgram.uniforms.uTexture, l.attach(0)), n.uniform1f(a.clearProgram.uniforms.value, 1), x(p.fbo), p), e.write = J(r, t, i, o, u, v), e } (function e() { (r.width != r.clientWidth || r.height != r.clientHeight) && (r.width = r.clientWidth, r.height = r.clientHeight, D()), function e() { E.length > 0 && E.pop(); for (var r = 0; r < u.length; r++) { var n = u[r]; n.moved && (U(n.x, n.y, n.dx, n.dy, n.color), 1 !== r && (n.moved = !1)) } if (R.multi_color && k + 100 < Date.now()) { k = Date.now(); for (var t = 0; t < u.length; t++)u[t].color = w() } }(), R.paused || function e(r) { n.disable(n.BLEND), n.viewport(0, 0, m, f), a.curlProgram.bind(), n.uniform2f(a.curlProgram.uniforms.texelSize, 1 / m, 1 / f), n.uniform1i(a.curlProgram.uniforms.uVelocity, p.read.attach(0)), x($.fbo), a.vorticityProgram.bind(), n.uniform2f(a.vorticityProgram.uniforms.texelSize, 1 / m, 1 / f), n.uniform1i(a.vorticityProgram.uniforms.uVelocity, p.read.attach(0)), n.uniform1i(a.vorticityProgram.uniforms.uCurl, $.attach(1)), n.uniform1f(a.vorticityProgram.uniforms.curl, R.curl), n.uniform1f(a.vorticityProgram.uniforms.dt, r), x(p.write.fbo), p.swap(), a.divergenceProgram.bind(), n.uniform2f(a.divergenceProgram.uniforms.texelSize, 1 / m, 1 / f), n.uniform1i(a.divergenceProgram.uniforms.uVelocity, p.read.attach(0)), x(h.fbo), a.clearProgram.bind(), n.uniform1i(a.clearProgram.uniforms.uTexture, S.read.attach(0)), n.uniform1f(a.clearProgram.uniforms.value, R.pressure), x(S.write.fbo), S.swap(), a.pressureProgram.bind(), n.uniform2f(a.pressureProgram.uniforms.texelSize, 1 / m, 1 / f), n.uniform1i(a.pressureProgram.uniforms.uDivergence, h.attach(0)); for (var t = 0; t < R.pressure_iteration; t++)n.uniform1i(a.pressureProgram.uniforms.uPressure, S.read.attach(1)), x(S.write.fbo), S.swap(); a.gradientSubtractProgram.bind(), n.uniform2f(a.gradientSubtractProgram.uniforms.texelSize, 1 / m, 1 / f), n.uniform1i(a.gradientSubtractProgram.uniforms.uPressure, S.read.attach(0)), n.uniform1i(a.gradientSubtractProgram.uniforms.uVelocity, p.read.attach(1)), x(p.write.fbo), p.swap(), a.advectionProgram.bind(), n.uniform2f(a.advectionProgram.uniforms.texelSize, 1 / m, 1 / f), o.supportLinearFiltering || n.uniform2f(a.advectionProgram.uniforms.dyeTexelSize, 1 / m, 1 / f); var i = p.read.attach(0); n.uniform1i(a.advectionProgram.uniforms.uVelocity, i), n.uniform1i(a.advectionProgram.uniforms.uSource, i), n.uniform1f(a.advectionProgram.uniforms.dt, r), n.uniform1f(a.advectionProgram.uniforms.dissipation, R.velocity), x(p.write.fbo), p.swap(), n.viewport(0, 0, c, d), o.supportLinearFiltering || n.uniform2f(a.advectionProgram.uniforms.dyeTexelSize, 1 / c, 1 / d), n.uniform1i(a.advectionProgram.uniforms.uVelocity, p.read.attach(0)), n.uniform1i(a.advectionProgram.uniforms.uSource, g.read.attach(1)), n.uniform1f(a.advectionProgram.uniforms.dissipation, R.dissipation), x(g.write.fbo), g.swap() }(.016), function e(t) { R.render_bloom && function e(r, t) { if (!(T.length < 2)) { var i = t; n.disable(n.BLEND), a.bloomPreFilterProgram.bind(); var o = R.threshold * R.soft_knee + 1e-4, u = R.threshold - o; n.uniform3f(a.bloomPreFilterProgram.uniforms.curve, u, 2 * o, .25 / o), n.uniform1f(a.bloomPreFilterProgram.uniforms.threshold, R.threshold), n.uniform1i(a.bloomPreFilterProgram.uniforms.uTexture, r.attach(0)), n.viewport(0, 0, i.width, i.height), x(i.fbo), a.bloomBlurProgram.bind(); for (var v = 0; v < T.length; v++) { var l = T[v]; n.uniform2f(a.bloomBlurProgram.uniforms.texelSize, 1 / i.width, 1 / i.height), n.uniform1i(a.bloomBlurProgram.uniforms.uTexture, i.attach(0)), n.viewport(0, 0, l.width, l.height), x(l.fbo), i = l } n.blendFunc(n.ONE, n.ONE), n.enable(n.BLEND); for (var m = T.length - 2; m >= 0; m--) { var f = T[m]; n.uniform2f(a.bloomBlurProgram.uniforms.texelSize, 1 / i.width, 1 / i.height), n.uniform1i(a.bloomBlurProgram.uniforms.uTexture, i.attach(0)), n.viewport(0, 0, f.width, f.height), x(f.fbo), i = f } n.disable(n.BLEND), a.bloomFinalProgram.bind(), n.uniform2f(a.bloomFinalProgram.uniforms.texelSize, 1 / i.width, 1 / i.height), n.uniform1i(a.bloomFinalProgram.uniforms.uTexture, i.attach(0)), n.uniform1f(a.bloomFinalProgram.uniforms.intensity, R.intensity), n.viewport(0, 0, t.width, t.height), x(t.fbo) } }(g.read, b), null != t && R.transparent ? n.disable(n.BLEND) : (n.blendFunc(n.ONE, n.ONE_MINUS_SRC_ALPHA), n.enable(n.BLEND)); var i = null == t ? n.drawingBufferWidth : c, o = null == t ? n.drawingBufferHeight : d; if (n.viewport(0, 0, i, o), !R.transparent) { a.colorProgram.bind(); var u = R.background_color; n.uniform4f(a.colorProgram.uniforms.color, u.r / 255, u.g / 255, u.b / 255, 1), x(t) } if (null == t && R.transparent && (a.backgroundProgram.bind(), n.uniform1f(a.backgroundProgram.uniforms.aspectRatio, r.width / r.height), x(null)), R.render_shaders) { var v = R.render_bloom ? a.displayBloomShadingProgram : a.displayShadingProgram; if (v.bind(), n.uniform2f(v.uniforms.texelSize, 1 / i, 1 / o), n.uniform1i(v.uniforms.uTexture, g.read.attach(0)), R.render_bloom) { n.uniform1i(v.uniforms.uBloom, b.attach(1)), n.uniform1i(v.uniforms.uDithering, P.attach(2)); var l = L(P, i, o); n.uniform2f(v.uniforms.ditherScale, l.x, l.y) } } else { var m = R.render_bloom ? a.displayBloomProgram : a.displayProgram; if (m.bind(), n.uniform1i(m.uniforms.uTexture, g.read.attach(0)), R.render_bloom) { n.uniform1i(m.uniforms.uBloom, b.attach(1)), n.uniform1i(m.uniforms.uDithering, P.attach(2)); var f = L(P, i, o); n.uniform2f(m.uniforms.ditherScale, f.x, f.y) } } x(t) }(null), requestAnimationFrame(e) })(); function U(e, t, i, o, u) { n.viewport(0, 0, m, f), a.splatProgram.bind(), n.uniform1i(a.splatProgram.uniforms.uTarget, p.read.attach(0)), n.uniform1f(a.splatProgram.uniforms.aspectRatio, r.width / r.height), n.uniform2f(a.splatProgram.uniforms.point, e / r.width, 1 - t / r.height), n.uniform3f(a.splatProgram.uniforms.color, i, -o, 1), n.uniform1f(a.splatProgram.uniforms.radius, R.emitter_size / 100), x(p.write.fbo), p.swap(), n.viewport(0, 0, c, d), n.uniform1i(a.splatProgram.uniforms.uTarget, g.read.attach(0)), n.uniform3f(a.splatProgram.uniforms.color, u.r, u.g, u.b), x(g.write.fbo), g.swap() } function w() { var e = function e(r, n, t) { var i, o, a, u, v, l, m, f; switch (u = Math.floor(6 * r), v = 6 * r - u, l = t * (1 - n), m = t * (1 - v * n), f = t * (1 - (1 - v) * n), u % 6) { case 0: i = t, o = f, a = l; break; case 1: i = m, o = t, a = l; break; case 2: i = l, o = t, a = f; break; case 3: i = l, o = m, a = t; break; case 4: i = f, o = l, a = t; break; case 5: i = t, o = l, a = m }return { r: i, g: o, b: a } }(Math.random(), 1, 1); return e.r *= .15, e.g *= .15, e.b *= .15, e } function F(e) { var r = n.drawingBufferWidth / n.drawingBufferHeight; r < 1 && (r = 1 / r); var t = Math.round(e * r), i = Math.round(e); return n.drawingBufferWidth > n.drawingBufferHeight ? { width: t, height: i } : { width: i, height: t } } function L(e, r, n) { return { x: r / e.width, y: n / e.height } } r.addEventListener("mousemove", function (e) { u[0].moved = u[0].down, u[0].dx = (e.offsetX - u[0].x) * 5, u[0].dy = (e.offsetY - u[0].y) * 5, u[0].x = e.offsetX, u[0].y = e.offsetY, u[0].down = !0, u[0].color = w() }), r.addEventListener("mousedown", function () { u[0].color = w() }), window.addEventListener("mouseup", function () { }), window.addEventListener("keydown", function (e) { "KeyP" === e.code && (R.paused = !R.paused), " " === e.key && E.push(parseInt(20 * Math.random()) + 5) }) }, r.setDitherURL = m; var t = o(n(/*! ./defualts */ "./src/defualts.js")), i = o(n(/*! ../assets/dither.png */ "./assets/dither.png")); function o(e) { if (e && e.__esModule) return e; var r = {}; if (null != e) { for (var n in e) if (Object.prototype.hasOwnProperty.call(e, n)) { var t = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(e, n) : {}; t.get || t.set ? Object.defineProperty(r, n, t) : r[n] = e[n] } } return r.default = e, r } function a(e, r) { if (!(e instanceof r)) throw TypeError("Cannot call a class as a function") } function u(e, r) { for (var n = 0; n < r.length; n++) { var t = r[n]; t.enumerable = t.enumerable || !1, t.configurable = !0, "value" in t && (t.writable = !0), Object.defineProperty(e, t.key, t) } } var v = !1, l = "./assets/dither.png"; function m(e) { l = e } var f = function () { var e, r, n; function t(e, r, n) { if (a(this, t), this.uniforms = {}, this.webGL = n, this.program = n.createProgram(), n.attachShader(this.program, e), n.attachShader(this.program, r), n.linkProgram(this.program), !n.getProgramParameter(this.program, n.LINK_STATUS)) throw n.getProgramInfoLog(this.program); for (var i = n.getProgramParameter(this.program, n.ACTIVE_UNIFORMS), o = 0; o < i; o++) { var u = n.getActiveUniform(this.program, o).name; this.uniforms[u] = n.getUniformLocation(this.program, u) } } return e = t, r = [{ key: "bind", value: function e() { this.webGL.useProgram(this.program) } }], u(e.prototype, r), n && u(e, n), t }(), s = function e() { a(this, e), this.id = -1, this.x = 0, this.y = 0, this.dx = 0, this.dy = 0, this.down = !1, this.moved = !1, this.color = [30, 0, 300] } } }) });